#define LDR 34
#define RAIN 25
#define R_MOTOR 32
#define L_MOTOR 33
#define PWM 26
int pwm = 0;
void setup() {
  Serial.begin(9600);

  pinMode(LDR, INPUT);
  pinMode(RAIN, INPUT);
  pinMode(R_MOTOR, OUTPUT);
  pinMode(L_MOTOR, OUTPUT);
  pinMode(PWM, OUTPUT);

  // แก้ไขลำดับการคำนวณ PWM
  int x = 10; 
  pwm = map(x, 0, 10, 0, 255);
  
}

void loop() {
  int rain = analogRead(RAIN);
  int light = analogRead(LDR);

  // วิธีการ Serial Print ที่ถูกต้องใน Arduino
  Serial.print("Bright: ");
  Serial.print(light);
  Serial.print(" | Water: ");
  Serial.println(rain);

  if(rain >700){
    analogWrite(26, pwm); 
    digitalWrite(L_MOTOR, LOW);
    digitalWrite(R_MOTOR, HIGH);
    delay(3000);
    analogWrite(26, 0);
    digitalWrite(L_MOTOR, LOW);
    digitalWrite(R_MOTOR, LOW);
    while(anologRead(RAIN) > 700){
      delay(200);
    }
  }
  if(rain < 600){
  // ตรรกะควบคุมไฟ (ถ้ามืด light จะมีค่าน้อย ขึ้นอยู่กับการต่อวงจร)
    if (light <= 300) {
      analogWrite(26, pwm); 
      digitalWrite(L_MOTOR, HIGH);
      digitalWrite(R_MOTOR, LOW);
      delay(3000);
      analogWrite(26, 0);
      digitalWrite(L_MOTOR, LOW);
      digitalWrite(R_MOTOR, LOW);
      while(analogRead(LDR) <= 300){
        delay(200);
      }
    } if(light > 400) {
      analogWrite(26, pwm); 
      digitalWrite(L_MOTOR, LOW);
      digitalWrite(R_MOTOR, HIGH);
      delay(3000);
      analogWrite(26, 0);
      digitalWrite(L_MOTOR, LOW);
      digitalWrite(R_MOTOR, LOW);
      while(analogRead(LDR) <= 300){
        delay(200);
      }
    }
  }

  delay(200); // หน่วงเวลาเล็กน้อยเพื่อให้ Serial อ่านทัน
}
